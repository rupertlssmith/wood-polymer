<link rel="import" href="libs/polymer/polymer.html" />

<dom-module id="wood-listbox">
    <template>

        <style>
          :host {
            display: block;
            padding: 8px 0;

            background: var(--wood-listbox-background-color, --primary-background-color);
            color: var(--wood-listbox-color, --primary-text-color);

            @apply(--wood-listbox);
          }
        </style>

          <content></content>
    </template>

    <script>
        (function() {
            var app;

            Polymer({
                app: null,
                is: "wood-listbox",
                properties: {
                    selected: {
                        type: Array,
                        notify: true,
                        value: [],
                        //reflectToAttribute: true
                    },

                    items: {
                        type: Array,
                        notify: true,
                        observer: '_itemsChanged',
                        value: []
                    },

                    src: {
                        type: String
                    }
                },
                attached() {
                    console.log("attached : items = " + this.items);

                    app = Elm.Listbox.embed(this);

                    this._itemsChanged(this.items, []);

                    app.ports.setSelected.subscribe(items => {
                        this.selected = items;
                    });
                },

                _itemsChanged: function(newValue, oldValue) {
                    console.log("_itemsChanged : items = " + newValue);

                    if (app) {
                        app.ports.itemsChanged.send(newValue);
                    }
                }
            });
        })();
    </script>
</dom-module>
